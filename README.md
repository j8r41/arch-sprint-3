# Sprint 3

## Задание 1: Анализ и проектирование

### Подзадание 1.1: Анализ и планирование

#### Схема управления отоплением:

- [Схема управления отоплением](schemas/task1-1.puml)

#### Анализ архитектуры монолитного приложения:

1. Язык программирования: Java
2. База данных: PostgreSQL
3. Архитектура: Монолитная, все компоненты системы (обработка запросов, бизнес-логика, работа с данными) находятся в рамках одного приложения.
4. Взаимодействие: Синхронное, запросы обрабатываются последовательно.
5. Масштабируемость: Ограничена, так как монолит сложно масштабировать по частям.
6. Развертывание: Требует остановки всего приложения.

#### Домены:

| Управление отоплением                                     | Мониторинг температуры                                      |
| --------------------------------------------------------- | ----------------------------------------------------------- |
| Пользователи включают и выключают отопление в своих домах | Система отопления получает данные о температуре с датчиков  |
| Пользователи устанавливают температуру                    | Пользователи получают текущую температуру через приложение. |
| Система отопления поддерживает заданную температуру       |                                                             |

### Подзадание 1.2: Архитектура микросервисов

#### Декомпозиция на микросервисы:

| Микросервис  | Описание                                  |
| ------------ | ----------------------------------------- |
| Телеметрия   | Обработка данных датчиков отопления       |
| Устройства   | Выполнение комманд датчиков и их контроль |
| Пользователи | Управление пользователями и домами        |

#### Определение взаимодействия.

1. Запросы пользователей идут в API Gateway.
2. API Gateway маршрутизирует запросы к микросервисам.
3. Микросервисы и устройства общаются через шину.
4. Микросервисы хранят данные в базе данных.

#### Визуализация архитектуры

##### C4 — Уровень контейнеров (Containers):

- [C4 — Уровень контейнеров](schemas/task1-2-3-containers.puml)

##### C4 — Уровень компонентов (Components):

- [C4 — Уровень контейнеров Телеметрия](schemas/task1-2-3-components-telemetry.puml)
- [C4 — Уровень контейнеров Устройства](schemas/task1-2-3-components-device.puml)
- [C4 — Уровень контейнеров Пользователи](schemas/task1-2-3-components-users.puml)

##### C4 — Уровень кода (Code):

- [C4 — Уровень кода Телеметрия](schemas/task1-2-3-code-telemetry.puml)

### Подзадание 1.3: ER-диаграмма

#### Идентификация сущностей

- Пользователь (User)
- Дом (House)
- Устройство (Device)
- Тип устройства (DeviceType)
- Модуль (Module)
- Телеметрия (Telemetry)

#### Определение атрибутов:

##### Сущность "Дом"

- **id** — идентификатор
- **user_id** — идентификатор пользователя — внешний ключ к Пользователю: один ко многим
- **address** — адрес дома

##### Сущность "Пользователь"

- **id** — идентификатор.
- **name** — имя пользователя.
- **surname** — фамилия пользователя

##### Сущность "Модуль"

- **id** — идентификатор
- **house_id** — идентификатор Дома: один к одному
- **device_type_id** — идентификатор к Типу устройства: один ко многим
- **serial_number** — серийный номер
- **title** — название

##### Сущность "Тип устройств"

- **id** — идентификатор
- **code** — код
- **description** — описание устройства

##### Сущность "Устройство"

- **id** — идентификатор
- **module_id** — идентификатор модуля — внешний ключ Модулю: один ко многим
- **serial_number** — серийный номер
- **status** — состояние устройства (вкл | выкл)

##### Сущность "Телеметрия"

- **id** — идентификатор
- **device_id** — идентификатор устройства, внешний ключ к Устройство: один ко многим
- **datetime** — дата и время получения данных
- **data** — данные телеметрии

#### Построение ER-диаграммы:

- [ER-диаграмма](schemas/task1-3.puml)
